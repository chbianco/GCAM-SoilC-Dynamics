labs(title = 'SOC k value comparison during land use transition')
ggplot() +
geom_histogram(aes(x = Full_Comparison$Exp_k,fill ='Experimental k'), alpha = 0.5) +
geom_histogram(aes(x = Full_Comparison$GCAM_k,  fill = 'GCAM k'), alpha = 0.5) +
xlab(expressio(k~(y^-1))) + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('Experimental k' = '#45912c', 'GCAM k'='#e3962b')) +
theme_light() +
labs(title = 'SOC k value comparison during land use transition')
ggplot() +
geom_histogram(aes(x = Full_Comparison$Exp_k,fill ='Experimental k'), alpha = 0.5) +
geom_histogram(aes(x = Full_Comparison$GCAM_k,  fill = 'GCAM k'), alpha = 0.5) +
xlab(expression(k~(y^-1))) + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('Experimental k' = '#45912c', 'GCAM k'='#e3962b')) +
theme_light() +
labs(title = 'SOC k value comparison during land use transition')
source("C:/Users/bian240/OneDrive - PNNL/Desktop/Initial Project Code/GCAM-SoilC-Dynamics/Meta_Analysis.R")
forest(
Full_effect_sizes_change$yi, Full_effect_sizes_change$vi,
annotate = TRUE,
slab = Full_fixed_effect_results_change$slab,
xlab = 'ln(Response Ratio)',
#Below sets the size of study labels, shape of bars, and size of x labels
cex = .8, pch = 15, cex.lab = 1
)
#Adding the summary effect size
addpoly.rma(
Full_fixed_effect_results_change,
col = 'orange', cex = 1, annotate = TRUE, mlab = 'Summary'
)
addpoly(
Full_fixed_effect_results_change,
col = 'orange', cex = 1, annotate = TRUE, mlab = 'Summary'
)
Full_fixed_effect_results
source("C:/Users/bian240/OneDrive - PNNL/Desktop/Initial Project Code/GCAM-SoilC-Dynamics/Full_Analysis.R")
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(ggplot2)
library(metafor)
#GCAM's SOC data
soilC <- read.csv(file = 'Data/GCAM_soilC.csv')
#GCAM's soil timescale list
timescales <- read.csv(file = 'Data/soil_timescales.csv')
#GCAM's land use region list [what does GLU stand for?????]
glus <- read.csv(file = 'Data/GLU_codes.csv')
#GCAM's geopolitical region list
regions <- read.csv('Data/GCAM_regions.csv')
#Merging the four above data sets
soilC %>%
mutate(GLU_code = GLU) %>%
right_join(glus, by='GLU_code') %>%
right_join(regions, by='GCAM_region_ID') %>%
right_join(timescales, by='GCAM_region_ID')-> soilC_regions
soilC_regions %>%
select(Land_Type, soil_c, GLU_code, Continent, soilTimeScale, GCAM_region_ID) -> simple_soilC_regions
PostKwon <- read.csv(file= 'Data/Experimental Data.csv', na.strings = c("", "NA"))
PostKwon %>%
select(Initial_Land_Use, Final_Land_Use, GLU_code, GCAM_region_ID, Time, Exp_Rate) %>%
na.omit() %>%
mutate(Land_Type = Initial_Land_Use) %>%
right_join( select(simple_soilC_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(initial_soil_c = soil_c) %>%
select(-Land_Type) %>%
mutate(Land_Type = Final_Land_Use) %>%
right_join( select(simple_soilC_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(final_soil_c = soil_c) %>%
select(-Land_Type, -soilTimeScale.x) %>%
rename(soilTimeScale = soilTimeScale.y) %>%
na.omit() %>%
mutate(GCAM_Rate = (final_soil_c - initial_soil_c)/soilTimeScale, Rate_Difference = Exp_Rate - GCAM_Rate,
Exp_k = -log(abs(Exp_Rate)*Time +1)/Time,
GCAM_k = -log(final_soil_c/initial_soil_c)/Time,
) %>%
#This next line corrects the sign of Exp_k--we had to take the absolute value to avoid NaNs, so this accounts for that
mutate(Exp_k = ifelse(sign(Exp_k) == sign(Exp_Rate), Exp_k*(-1), Exp_k)) -> Rate_Comparison
Wei <- read.csv(file= 'Data/Wei et al Data.csv', na.strings = c("", "NA"))
#Creating the Post & Kwon comparison data
PostKwon %>%
select(Initial_Land_Use, Final_Land_Use, GLU_code, GCAM_region_ID, Time, Exp_Rate) %>%
na.omit() %>%
mutate(Land_Type = Initial_Land_Use) %>%
right_join(simple_soilC_regions, by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(initial_soil_c = soil_c) %>%
select(-Land_Type) %>%
mutate(Land_Type = Final_Land_Use) %>%
right_join(simple_soilC_regions, by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(final_soil_c = soil_c) %>%
select(-Land_Type, -soilTimeScale.x) %>%
rename(soilTimeScale = soilTimeScale.y) %>%
na.omit() %>%
mutate(GCAM_Rate = (final_soil_c - initial_soil_c)/soilTimeScale, Rate_Difference = Exp_Rate - GCAM_Rate,
Exp_k = -log(abs(Exp_Rate)*Time +1)/Time,
GCAM_k = -log(final_soil_c/initial_soil_c)/Time,
source = 'Post & Kwon'
) %>%
#This next line corrects the sign of Exp_k--we had to take the absolute value to avoid NaNs, so this accounts for that
mutate(Exp_k = ifelse(sign(Exp_k) == sign(Exp_Rate), Exp_k*(-1), Exp_k)) -> PostKwon_Comparison
#Creating the Wei et al comparison data
Wei %>%
select(Initial_Land_Use, Final_Land_Use, GLU_code, GCAM_region_ID, OC_decrease, Time) %>%
na.omit() %>%
mutate(Land_Type = Initial_Land_Use) %>%
right_join(simple_soilC_regions, by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(initial_soil_c = soil_c) %>%
select(-Land_Type) %>%
mutate(Land_Type = Final_Land_Use) %>%
right_join(simple_soilC_regions, by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(final_soil_c = soil_c) %>%
select(-Land_Type, -soilTimeScale.x) %>%
rename(soilTimeScale = soilTimeScale.y) %>%
na.omit() %>%
mutate(GCAM_Rate = (final_soil_c - initial_soil_c)/soilTimeScale,
GCAM_k = -log(final_soil_c/initial_soil_c)/Time,
Exp_k = -log(1/((abs(OC_decrease)/100) +1))/Time,
source = 'Wei et al'
) %>%
#This next line corrects the sign of Exp_k--we had to take the absolute value to avoid NaNs, so this accounts for that
mutate(Exp_k = ifelse(sign(Exp_k) == sign(OC_decrease), Exp_k, Exp_k*(-1))) -> Wei_Comparison
Full_Comparison <- bind_rows(
select(PostKwon_Comparison, -Exp_Rate, -Rate_Difference),
select(Wei_Comparison, -OC_decrease)
)
#First, we need to get mean, std dev, and n
Full_Comparison %>%
group_by(GLU_code) %>%
summarize(mean_control = mean(Exp_k), sd_control= sd(Exp_k), n_control = n(),
mean_GCAM = mean(GCAM_k), sd_GCAM = sd(GCAM_k), n_GCAM = n()
) -> Full_MA_data
#Now, we can use escalc to get the standardized mean difference
Full_effect_sizes <-
escalc('SMD',
m1i = mean_control, n1i = n_control, sd1i = sd_control,
m2i = mean_GCAM, n2i = n_GCAM, sd2i = sd_GCAM,
data = Full_MA_data
)
#We're going to use a fixed effect model for this analysis, which we set up below
Full_fixed_effect_results <- rma(yi, vi, method = 'FE',
slab = GLU_code,
data = Full_effect_sizes)
#First, we need to get mean, std dev, and n
PostKwon_Comparison %>%
group_by(GLU_code) %>%
summarize(mean_control = mean(Exp_k), sd_control= sd(Exp_k), n_control = n(),
mean_GCAM = mean(GCAM_k), sd_GCAM = sd(GCAM_k), n_GCAM = n()
) -> PostKwon_MA_k_data
#Now, we can use escalc to get the standardized mean difference
PostKwon_k_effect_sizes <-
escalc('SMD',
m1i = mean_control, n1i = n_control, sd1i = sd_control,
m2i = mean_GCAM, n2i = n_GCAM, sd2i = sd_GCAM,
data = PostKwon_MA_k_data
)
#We're going to use a fixed effect model for this analysis, which we set up below
PostKwon_k_fixed_effect_results <- rma(yi, vi, method = 'FE',
slab = GLU_code,
data = PostKwon_k_effect_sizes)
#Now for the Wei et al. data
#First, we need to get mean, std dev, and n
Wei_Comparison %>%
group_by(GLU_code) %>%
summarize(mean_control = mean(Exp_k), sd_control= sd(Exp_k), n_control = n(),
mean_GCAM = mean(GCAM_k), sd_GCAM = sd(GCAM_k), n_GCAM = n()
) -> Wei_MA_data
#Now, we can use escalc to get the standardized mean difference
Wei_effect_sizes <-
escalc('SMD',
m1i = mean_control, n1i = n_control, sd1i = sd_control,
m2i = mean_GCAM, n2i = n_GCAM, sd2i = sd_GCAM,
data = Wei_MA_data
)
#We're going to use a fixed effect model for this analysis, which we set up below
Wei_fixed_effect_results <- rma(yi, vi, method = 'FE',
slab = GLU_code,
data = Wei_effect_sizes)
#Plot overlapping rate histograms for the different rate sources
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Exp_Rate, fill ='Experimental Rate' ), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_Rate, fill = 'GCAM Rate'), alpha = 0.5) +
xlab('Rate (kg C/m^2-y)') + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('Experimental Rate' = '#45912c', 'GCAM Rate'='#e3962b')) +
theme_light() +
labs(title = 'SOC rate comparison during land use transition')
#Plot overlapping k histograms for the different k sources
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Exp_k,fill ='Experimental k'), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_k,  fill = 'GCAM k'), alpha = 0.5) +
xlab('k (y^-1)') + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('Experimental k' = '#45912c', 'GCAM k'='#e3962b')) +
theme_light() +
labs(title = 'SOC k value comparison during land use transition')
t.test(Rate_Comparison$Exp_Rate, Rate_Comparison$GCAM_Rate, alternative = 'two.sided') ->Rate_T_test
print(Rate_T_test)
t.test(Rate_Comparison$Exp_k, Rate_Comparison$GCAM_k, alternative = 'two.sided') ->k_T_test
print(k_T_test)
#Plot overlapping k histograms for the different k sources
ggplot() +
geom_histogram(aes(x = Full_Comparison$Exp_k,fill ='Experimental k'), alpha = 0.5, bins = 75) +
geom_histogram(aes(x = Full_Comparison$GCAM_k,  fill = 'GCAM k'), alpha = 0.5, bins = 75) +
xlab('k (y^-1)') + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('Experimental k' = '#45912c', 'GCAM k'='#e3962b')) +
theme_light() +
labs(title = 'SOC k value comparison during land use transition')
t.test(Full_Comparison$Exp_k, Full_Comparison$GCAM_k, alternative = 'two.sided')
PostKwon_k_fixed_effect_results
#Forest plot for Post & Kwon k vals
forest(
PostKwon_k_effect_sizes$yi, PostKwon_k_effect_sizes$vi,
annotate = FALSE,
slab = PostKwon_k_fixed_effect_results$slab,
xlab = 'ln(Response Ratio)',
#Below sets the size of study labels, shape of bars, and size of x labels
cex = .8, pch = 15, cex.lab = 1
)
#Adding the summary effect size
addpoly(
PostKwon_k_fixed_effect_results,
col = 'orange', cex = 1, annotate = TRUE, mlab = 'Summary'
)
Wei_fixed_effect_results
#Forest plot for Wei
forest(
Wei_effect_sizes$yi, Wei_effect_sizes$vi,
annotate = FALSE,
slab = Wei_fixed_effect_results$slab,
xlab = 'ln(Response Ratio)',
#Below sets the size of study labels, shape of bars, and size of x labels
cex = .8, pch = 15, cex.lab = 1
)
#Adding the summary effect size
addpoly(
Wei_fixed_effect_results,
col = 'orange', cex = 1, annotate = TRUE, mlab = 'Summary'
)
Full_fixed_effect_results
#Forest plot for full dataset
forest(
Full_effect_sizes$yi, Full_effect_sizes$vi,
annotate = TRUE,
slab = Full_fixed_effect_results$slab,
xlab = 'ln(Response Ratio)',
#Below sets the size of study labels, shape of bars, and size of x labels
cex = .8, pch = 15, cex.lab = 1
)
#Adding the summary effect size
addpoly(
Full_fixed_effect_results,
col = 'orange', cex = 1, annotate = TRUE, mlab = 'Summary'
)
source("C:/Users/bian240/OneDrive - PNNL/Desktop/Initial Project Code/GCAM-SoilC-Dynamics/PostKwon_Analysis.R")
#Plot overlapping rate histograms for the different rate sources
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Exp_Rate, fill ='Experimental Rate' ), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_Rate, fill = 'GCAM Rate'), alpha = 0.5) +
xlab('Rate (kg C/m^2)') + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('Experimental Rate' = '#45912c', 'GCAM Rate'='#e3962b')) +
theme_light() +
labs(title = 'SOC rate comparison during land use transition')
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Exp_k,fill ='Experimental'), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_k,  fill = 'GCAM'), alpha = 0.5) +
xlab('k (y^-1)') + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('Experimental k' = '#45912c', 'GCAM k'='#e3962b')) +
theme_light() +
labs(title = 'SOC k value comparison during land use transition')
#Plot overlapping k histograms for the different k sources
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Exp_k,fill ='Experimental'), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_k,  fill = 'GCAM'), alpha = 0.5) +
xlab('k (y^-1)') + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('Experimental' = '#45912c', 'GCAM'='#e3962b')) +
theme_light() +
labs(title = 'SOC k value comparison during land use transition')
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Exp_k,fill ='Experimental'), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_k,  fill = 'GCAM'), alpha = 0.5) +
xlab(expresion(k~(y^-1))) + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('Experimental' = '#45912c', 'GCAM'='#e3962b')) +
theme_light() +
labs(title = 'SOC k value comparison during land use transition')
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Exp_k,fill ='Experimental'), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_k,  fill = 'GCAM'), alpha = 0.5) +
xlab(expression(k~(y^-1))) + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('Experimental' = '#45912c', 'GCAM'='#e3962b')) +
theme_light() +
labs(title = 'SOC k value comparison during land use transition')
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Exp_k,fill ='Experimental'), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_k,  fill = 'GCAM'), alpha = 0.5) +
xlab(expression(k~(y^-1))) + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('Experimental' = '#45912c', 'GCAM'='#e3962b')) +
theme_light()
jpeg(file = 'Post Kwon k Hist.jpeg')
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Exp_k,fill ='Experimental'), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_k,  fill = 'GCAM'), alpha = 0.5) +
xlab(expression(k~(y^-1))) + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('Experimental' = '#45912c', 'GCAM'='#e3962b')) +
theme_light()
dev.off()
jpeg(file = 'Post Kwon k Hist.jpeg')
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Exp_k,fill ='Experimental k'), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_k,  fill = 'GCAM k'), alpha = 0.5) +
xlab('k (y^-1)') + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('Experimental k' = '#45912c', 'GCAM k'='#e3962b')) +
theme_light() +
labs(title = 'SOC k value comparison during land use transition')
dev.off()
jpeg(file = 'Wei k Hist.jpeg')
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Exp_k,fill ='Experimental k'), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_k,  fill = 'GCAM k'), alpha = 0.5) +
xlab('k (y^-1)') + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('Experimental k' = '#45912c', 'GCAM k'='#e3962b')) +
theme_light() +
labs(title = 'SOC k value comparison during land use transition')
dev.off()
jpeg(file = 'Full k Hist.jpeg')
ggplot() +
geom_histogram(aes(x = Full_Comparison$Exp_k,fill ='Experimental k'), alpha = 0.5) +
geom_histogram(aes(x = Full_Comparison$GCAM_k,  fill = 'GCAM k'), alpha = 0.5) +
xlab(expression(k~(y^-1))) + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('Experimental k' = '#45912c', 'GCAM k'='#e3962b')) +
theme_light() +
dev.off()
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Exp_k,fill ='Experimental'), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_k,  fill = 'GCAM'), alpha = 0.5) +
xlab(expression(k~(y^-1))) + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('Experimental' = '#45912c', 'GCAM'='#e3962b')) +
theme_light()
jpeg(file = 'Wei k Hist.jpeg')
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Exp_k,fill ='Experimental'), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_k,  fill = 'GCAM'), alpha = 0.5) +
xlab(expression(k~(y^-1))) + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('Experimental' = '#45912c', 'GCAM'='#e3962b')) +
theme_light()
dev.off()
ggplot() +
geom_histogram(aes(x = Full_Comparison$Exp_k,fill ='Experimental'), alpha = 0.5) +
geom_histogram(aes(x = Full_Comparison$GCAM_k,  fill = 'GCAM'), alpha = 0.5) +
xlab(expression(k~(y^-1))) + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('Experimental' = '#45912c', 'GCAM'='#e3962b')) +
theme_light()
ggplot() +
geom_histogram(aes(x = Full_Comparison$Exp_k,fill ='Experimental'), alpha = 0.5, bins = 75) +
geom_histogram(aes(x = Full_Comparison$GCAM_k,  fill = 'GCAM'), alpha = 0.5, bins = 75) +
xlab(expression(k~(y^-1))) + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('Experimental' = '#45912c', 'GCAM'='#e3962b')) +
theme_light()
jpeg(file = 'Wei k Hist.jpeg')
ggplot() +
geom_histogram(aes(x = Full_Comparison$Exp_k,fill ='Experimental'), alpha = 0.5, bins = 75) +
geom_histogram(aes(x = Full_Comparison$GCAM_k,  fill = 'GCAM'), alpha = 0.5, bins = 75) +
xlab(expression(k~(y^-1))) + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('Experimental' = '#45912c', 'GCAM'='#e3962b')) +
theme_light()
dev.off()
jpeg(file = 'Full k Hist.jpeg')
ggplot() +
geom_histogram(aes(x = Full_Comparison$Exp_k,fill ='Experimental'), alpha = 0.5, bins = 75) +
geom_histogram(aes(x = Full_Comparison$GCAM_k,  fill = 'GCAM'), alpha = 0.5, bins = 75) +
xlab(expression(k~(y^-1))) + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('Experimental' = '#45912c', 'GCAM'='#e3962b')) +
theme_light()
dev.off()
source("C:/Users/bian240/OneDrive - PNNL/Desktop/Initial Project Code/GCAM-SoilC-Dynamics/Full_Analysis.R")
?forest
library(metafor)
?forest
?rma
source("C:/Users/bian240/OneDrive - PNNL/Desktop/Initial Project Code/GCAM-SoilC-Dynamics/Meta_Analysis.R")
forest(
Full_effect_sizes_change$yi, Full_effect_sizes_change$vi,
annotate = TRUE,
slab = Full_fixed_effect_results_change$slab,
xlab = 'ln(Response Ratio)',
#Below sets the size of study labels, shape of bars, and size of x labels
cex = .8, pch = 15, cex.lab = 1
)
forest(
Full_fixed_effect_results_change$yi, Full_fixed_effect_results_change$vi,
annotate = TRUE,
slab = Full_fixed_effect_results_change$slab,
xlab = 'ln(Response Ratio)',
#Below sets the size of study labels, shape of bars, and size of x labels
cex = .8, pch = 15, cex.lab = 1
)
Full_fixed_effect_results_change <- rma(yi, vi, method = 'FE',
slab = change,
data = Full_effect_sizes_change)
source("C:/Users/bian240/OneDrive - PNNL/Desktop/Initial Project Code/GCAM-SoilC-Dynamics/Meta_Analysis.R")
forest(
Full_fixed_effect_results_change$yi, Full_fixed_effect_results_change$vi,
annotate = TRUE,
slab = Full_fixed_effect_results_change$slab,
xlab = 'ln(Response Ratio)',
#Below sets the size of study labels, shape of bars, and size of x labels
cex = .8, pch = 15, cex.lab = 1
)
forest(
Full_effect_sizes_change$yi, Full_effect_sizes_change$vi,
annotate = TRUE,
slab = Full_fixed_effect_results_change$slab,
xlab = 'ln(Response Ratio)',
#Below sets the size of study labels, shape of bars, and size of x labels
cex = .8, pch = 15, cex.lab = 1
)
Full_fixed_effect_results_change
#Plotting
#Plot by GCAM32 region
ggplot(data = total_transitions_gcam32, aes(x=total_skqm_change, y=change)) +
geom_bar(stat='identity') +
facet_wrap(~region_id)
#Plot in total
ggplot(data = total_transitions, aes(x = total_skqm_change, y = change)) +
geom_bar(stat='identity')
source("C:/Users/bian240/OneDrive - PNNL/Desktop/Initial Project Code/GCAM-SoilC-Dynamics/Track_Transitions.R")
read.csv(file = 'Data/soil_timescales.csv') %>%
mutate(GCAM_region_ID = seq(1,32,by=1))
source("C:/Users/bian240/OneDrive - PNNL/Desktop/Initial Project Code/GCAM-SoilC-Dynamics/Full_Analysis.R")
View(Full_Comparison)
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Exp_k,fill ='Experimental'), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_k,  fill = 'GCAM'), alpha = 0.5) +
xlab(expression(k~(y^-1))) + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('Experimental' = '#45912c', 'GCAM'='#e3962b')) +
theme_light()
source("C:/Users/bian240/OneDrive - PNNL/Desktop/Initial Project Code/GCAM-SoilC-Dynamics/Wei_Analysis.R")
source("C:/Users/bian240/OneDrive - PNNL/Desktop/Initial Project Code/GCAM-SoilC-Dynamics/Full_Analysis.R")
ggplot() +
geom_histogram(aes(x = Full_Comparison$Exp_k,fill ='Experimental'), alpha = 0.5, bins = 75) +
geom_histogram(aes(x = Full_Comparison$GCAM_k,  fill = 'GCAM'), alpha = 0.5, bins = 75) +
xlab(expression(k~(y^-1))) + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('Experimental' = '#45912c', 'GCAM'='#e3962b')) +
theme_light()
View(Full_Comparison)
ggplot() +
geom_histogram(aes(x = Full_Comparison$Exp_k, fill = source), alpha = 0.5, bins = 75) +
geom_histogram(aes(x = Full_Comparison$GCAM_k,  fill = 'GCAM'), alpha = 0.5, bins = 75) +
xlab(expression(k~(y^-1))) + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('GCAM'='#e3962b')) +
theme_light()
ggplot() +
geom_histogram(aes(x = Full_Comparison$Exp_k, fill = 'source'), alpha = 0.5, bins = 75) +
geom_histogram(aes(x = Full_Comparison$GCAM_k,  fill = 'GCAM'), alpha = 0.5, bins = 75) +
xlab(expression(k~(y^-1))) + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('GCAM'='#e3962b')) +
theme_light()
ggplot() +
geom_histogram(aes(x = Full_Comparison$Exp_k, fill = source), alpha = 0.5, bins = 75) +
geom_histogram(aes(x = Full_Comparison$GCAM_k,  fill = 'GCAM'), alpha = 0.5, bins = 75) +
xlab(expression(k~(y^-1))) + ylab('Count')
ggplot() +
geom_histogram(aes(x = Full_Comparison$Exp_k, fill = after_stat(source)), alpha = 0.5, bins = 75) +
geom_histogram(aes(x = Full_Comparison$GCAM_k,  fill = 'GCAM'), alpha = 0.5, bins = 75) +
xlab(expression(k~(y^-1))) + ylab('Count')
ggplot() +
geom_histogram(aes(x = Full_Comparison$Exp_k, fill = Full_Comparison$source), alpha = 0.5, bins = 75)
ggplot() +
geom_histogram(aes(x = Full_Comparison$Exp_k, fill = Full_Comparison$source), alpha = 0.5, bins = 75) +
geom_histogram(aes(x = Full_Comparison$GCAM_k,  fill = 'GCAM'), alpha = 0.5, bins = 75) +
xlab(expression(k~(y^-1))) + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('GCAM'='#e3962b')) +
theme_light()
ggplot() +
geom_histogram(aes(x = Full_Comparison$Exp_k, fill = Full_Comparison$source), alpha = 0.5, bins = 75) +
geom_histogram(aes(x = Full_Comparison$GCAM_k,  fill = 'GCAM'), alpha = 0.5, bins = 75)
ggplot() +
geom_histogram(aes(x = Full_Comparison$Exp_k, fill = Full_Comparison$source), alpha = 0.5, bins = 75) +
geom_histogram(aes(x = Full_Comparison$GCAM_k,  fill = 'GCAM'), alpha = 0.5, bins = 75) +
xlab(expression(k~(y^-1))) + ylab('Count') +
scale_fill_manual(name = "Data Source",
values = c('GCAM'='#e3962b', 'Wei et al' = '#45912c', 'Post & Kwon' = '#3584B0')) +
theme_light()
source("C:/Users/bian240/OneDrive - PNNL/Desktop/Initial Project Code/GCAM-SoilC-Dynamics/Wei_Analysis.R")
View(Wei)
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Exp_k,fill ='Experimental'), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_k,  fill = 'GCAM'), alpha = 0.5) +
xlab(expression(k~(y^-1))) + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('Wei et al' = '#45912c', 'GCAM'='#e3962b')) +
theme_light()
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Exp_k,fill ='Wei et al'), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_k,  fill = 'GCAM'), alpha = 0.5) +
xlab(expression(k~(y^-1))) + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('Wei et al' = '#45912c', 'GCAM'='#e3962b')) +
theme_light()
source("C:/Users/bian240/OneDrive - PNNL/Desktop/Initial Project Code/GCAM-SoilC-Dynamics/PostKwon_Analysis.R")
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Exp_k,fill ='Post & Kwon'), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_k,  fill = 'GCAM'), alpha = 0.5) +
xlab(expression(k~(y^-1))) + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('Post & Kwon' = '#3584B0', 'GCAM'='#e3962b')) +
theme_light()
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Exp_Rate, fill ='Post & Kwon' ), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_Rate, fill = 'GCAM Rate'), alpha = 0.5) +
xlab('Rate (kg C/m^2)') + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('Post & Kwon' = '#3584B0', 'GCAM Rate'='#e3962b')) +
theme_light() +
labs(title = 'SOC rate comparison during land use transition')
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Exp_Rate, fill ='Post & Kwon' ), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_Rate, fill = 'GCAM Rate'), alpha = 0.5) +
xlab(expression(Rate~(kg~C/m^2))) + ylab('Count') +
scale_fill_manual(name = "Data Source", values = c('Post & Kwon' = '#3584B0', 'GCAM Rate'='#e3962b')) +
theme_light()
source("C:/Users/bian240/OneDrive - PNNL/Desktop/Initial Project Code/GCAM-SoilC-Dynamics/Meta_Analysis.R")
