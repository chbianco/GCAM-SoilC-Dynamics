mutate(Land_Type = Final_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(final_soil_c = soil_c) %>%
select(-Land_Type) %>%
select(-soilTimeScale.x) %>%
rename(soilTimeScale = soilTimeScale.y) %>%
na.omit() %>%
mutate(GCAM_Rate = (final_soil_c - initial_soil_c)/soilTimeScale) -> Rate_Comparison
PostKwon <- read.csv(file= 'C:/Users/bian240/OneDrive - PNNL/Desktop/Initial Project Code/Post_Kwon.csv', na.strings = c("", "NA"))
PostKwon %>%
na.omit() %>%
mutate(Land_Type = Initial_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(initial_soil_c = soil_c) %>%
select(-Land_Type) %>%
select(-Rate_old) %>%
mutate(Land_Type = Final_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(final_soil_c = soil_c) %>%
select(-Land_Type) %>%
select(-soilTimeScale.x) %>%
rename(soilTimeScale = soilTimeScale.y) %>%
na.omit() %>%
mutate(GCAM_Rate = (final_soil_c - initial_soil_c)/soilTimeScale) -> Rate_Comparison
Rate_Comparison
na.omit(PostKwon)
filter(simple_soilC_with_regions, GLU_code == 'GLU234')
length(na.omit(PostKwon))
size(na.omit(PostKwon))
count(na.omit(PostKwon))
Rate_Comparison
?abs
PostKwon %>%
na.omit() %>%
mutate(Land_Type = Initial_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(initial_soil_c = soil_c) %>%
select(-Land_Type) %>%
select(-Rate_old) %>%
mutate(Land_Type = Final_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(final_soil_c = soil_c) %>%
select(-Land_Type) %>%
select(-soilTimeScale.x) %>%
rename(soilTimeScale = soilTimeScale.y) %>%
na.omit() %>%
mutate(GCAM_Rate = (final_soil_c - initial_soil_c)/soilTimeScale) %>%
mutate(Rate_Difference = abs(Rate - GCAM_Rate))-> Rate_Comparison
Rate_Comparison
ggplot(data = Rate_Comparison, aes(x = Rate, y = GCAM_Rate)) +
geom_point()
View(Rate_Comparison)
filter(simple_soilC_with_regions, GLU_code == 'GLU234')
PostKwon %>%
na.omit() %>%
mutate(Land_Type = Initial_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(initial_soil_c = soil_c) %>%
select(-Land_Type, -Rate_old) %>%
mutate(Land_Type = Final_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(final_soil_c = soil_c) %>%
select(-Land_Type) %>%
select(-soilTimeScale.x) %>%
rename(soilTimeScale = soilTimeScale.y) %>%
na.omit() %>%
mutate(GCAM_Rate = (final_soil_c - initial_soil_c)/soilTimeScale) %>%
mutate(Rate_Difference = abs(Rate - GCAM_Rate))-> Rate_Comparison
Rate_Comparison
PostKwon %>%
na.omit() %>%
mutate(Land_Type = Initial_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(initial_soil_c = soil_c) %>%
select(-Land_Type, -Rate_old) %>%
mutate(Land_Type = Final_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(final_soil_c = soil_c) %>%
select(-Land_Type, -soilTimeScale.x) %>%
rename(soilTimeScale = soilTimeScale.y) %>%
na.omit() %>%
mutate(GCAM_Rate = (final_soil_c - initial_soil_c)/soilTimeScale) %>%
mutate(Rate_Difference = abs(Rate - GCAM_Rate))-> Rate_Comparison
Rate_Comparison
ggplot(data = Continent_soilC_avg, aes(x=Land_Type, y=mean, fill = Land_Type)) +
geom_bar(stat='identity') +
geom_errorbar(aes( ymin = mean-sd, ymax=mean+sd)) +
facet_wrap(~Continent) +
scale_fill_manual(values=c('#f5ce42', '#298a17', '#526cde')) +
xlab('Land Type') + ylab('Soil Carbon (kg/m^2)')
PostKwon %>%
na.omit() %>%
mutate(Land_Type = Initial_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(initial_soil_c = soil_c) %>%
select(-Land_Type, -Rate_old) %>%
mutate(Land_Type = Final_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(final_soil_c = soil_c) %>%
select(-Land_Type, -soilTimeScale.x) %>%
rename(soilTimeScale = soilTimeScale.y) %>%
na.omit() %>%
mutate(GCAM_Rate = (final_soil_c - initial_soil_c)/soilTimeScale, Rate_Difference = Rate - GCAM_Rate) -> Rate_Comparison
Rate_Comparison
ggplot(data = Rate_Comparison, aes(x = Rate, y = GCAM_Rate)) +
geom_point() +
geom_abline()
ggplot(data = Rate_Comparison, aes(x = Rate, y = GCAM_Rate)) +
geom_point() +
geom_abline() +
xlab('Experimental Rates') + ylab('GCAM Derived Rates')
ggplot() +
geom_histogram(data = Rate_Comparison, x = Rate) +
geom_histogram(data = Rate_Comparison, x = GCAM_Rate)
ggplot() +
geom_histogram(x = Rate_Comparison$Rate) +
geom_histogram(x = Rate_Comparison$GCAM_Rate)
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Rate, fill = 'Experimental Rates')) +
geom_histogram(aes(x = Rate_Comparison$GCAM_Rate), fill = 'GCAM Derived Rates')
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Rate)) +
geom_histogram(aes(x = Rate_Comparison$GCAM_Rate))
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Rate, fill = '#45912c'), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_Rate, fill = '#e3962b'), alpha = 0.5)
PostKwon %>%
na.omit() %>%
mutate(Land_Type = Initial_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(initial_soil_c = soil_c) %>%
select(-Land_Type, -Rate_old) %>%
mutate(Land_Type = Final_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(final_soil_c = soil_c) %>%
select(-Land_Type, -soilTimeScale.x) %>%
rename(soilTimeScale = soilTimeScale.y) %>%
na.omit() %>%
mutate(GCAM_Rate = (final_soil_c - initial_soil_c)/soilTimeScale, Rate_Difference = Rate - GCAM_Rate) %>%
mutate(Experimental_k = -ln(Rate*Time +1)/Time)-> Rate_Comparison
PostKwon <- read.csv(file= 'C:/Users/bian240/OneDrive - PNNL/Desktop/Initial Project Code/Post_Kwon.csv', na.strings = c("", "NA"))
PostKwon %>%
na.omit() %>%
mutate(Land_Type = Initial_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(initial_soil_c = soil_c) %>%
select(-Land_Type, -Rate_old) %>%
mutate(Land_Type = Final_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(final_soil_c = soil_c) %>%
select(-Land_Type, -soilTimeScale.x) %>%
rename(soilTimeScale = soilTimeScale.y) %>%
na.omit() %>%
mutate(GCAM_Rate = (final_soil_c - initial_soil_c)/soilTimeScale, Rate_Difference = Rate - GCAM_Rate) %>%
mutate(Experimental_k = -log(Rate*Time +1)/Time)-> Rate_Comparison
PostKwon %>%
na.omit() %>%
mutate(Land_Type = Initial_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(initial_soil_c = soil_c) %>%
select(-Land_Type, -Rate_old) %>%
mutate(Land_Type = Final_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(final_soil_c = soil_c) %>%
select(-Land_Type, -soilTimeScale.x) %>%
rename(soilTimeScale = soilTimeScale.y) %>%
na.omit() %>%
mutate(GCAM_Rate = (final_soil_c - initial_soil_c)/soilTimeScale, Rate_Difference = Rate - GCAM_Rate) %>%
mutate(Experimental_k = -log(abs(Rate)*Time +1)/Time)-> Rate_Comparison
Rate_Comparison
PostKwon %>%
na.omit() %>%
mutate(Land_Type = Initial_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(initial_soil_c = soil_c) %>%
select(-Land_Type, -Rate_old) %>%
mutate(Land_Type = Final_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(final_soil_c = soil_c) %>%
select(-Land_Type, -soilTimeScale.x) %>%
rename(soilTimeScale = soilTimeScale.y) %>%
na.omit() %>%
mutate(GCAM_Rate = (final_soil_c - initial_soil_c)/soilTimeScale, Rate_Difference = Rate - GCAM_Rate) %>%
mutate(Experimental_k = -log(abs(Rate)*Time +1)/Time) %>%
mutate(GCAM_k = -log(final_soil_c/initial_soil_c)/Time  )-> Rate_Comparison
Rate_Comparison
#Plot overlapping rate histograms for the different rate sources
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Rate, fill = '#45912c'), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_Rate, fill = '#e3962b'), alpha = 0.5) +
xlab('Rate') + ylab('Count')
#Plot overlapping rate histograms for the different rate sources
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Experimental_k, fill = '#45912c'), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_k, fill = '#e3962b'), alpha = 0.5) +
xlab('k') + ylab('Count')
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Rate, fill ='data1' ), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_Rate, fill = 'data2'), alpha = 0.5) +
xlab('Rate') + ylab('Count') +
scale_fill_manual(values = c('data1' = '#45912c', 'data2'='#e3962b'))
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Rate, fill ='Experimental Rate' ), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_Rate, fill = 'GCAM Rate'), alpha = 0.5) +
xlab('Rate') + ylab('Count') +
scale_fill_manual(values = c('Experimental Rate' = '#45912c', 'GCAM Rate'='#e3962b'))
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Experimental_k,fill ='Experimental k'), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_k,  fill = 'GCAM k'), alpha = 0.5) +
xlab('k') + ylab('Count') +
scale_fill_manual(values = c('Experimental k' = '#45912c', 'GCAM k'='#e3962b'))
PostKwon <- read.csv(file= 'C:/Users/bian240/OneDrive - PNNL/Desktop/Initial Project Code/Experimental Data.csv', na.strings = c("", "NA"))
PostKwon <- read.csv(file= 'C:/Users/bian240/OneDrive - PNNL/Desktop/Initial Project Code/Experimental Data.csv', na.strings = c("", "NA"))
PostKwon
PostKwon %>%
select(Initial_Land_Use, Final_Land_Use, GLU_code, GCAM_region_ID, Time, GCAM_Rate)
na.omit() %>%
mutate(Land_Type = Initial_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(initial_soil_c = soil_c) %>%
select(-Land_Type) %>%
mutate(Land_Type = Final_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(final_soil_c = soil_c) %>%
select(-Land_Type, -soilTimeScale.x) %>%
rename(soilTimeScale = soilTimeScale.y) %>%
na.omit() %>%
mutate(GCAM_Rate = (final_soil_c - initial_soil_c)/soilTimeScale, Rate_Difference = Rate - GCAM_Rate) %>%
mutate(Experimental_k = -log(abs(Rate)*Time +1)/Time) %>%
mutate(GCAM_k = -log(final_soil_c/initial_soil_c)/Time) -> Rate_Comparison
PostKwon %>%
select(Initial_Land_Use, Final_Land_Use, GLU_code, GCAM_region_ID, Time, GCAM_Rate) %>%
na.omit() %>%
mutate(Land_Type = Initial_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(initial_soil_c = soil_c) %>%
select(-Land_Type) %>%
mutate(Land_Type = Final_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(final_soil_c = soil_c) %>%
select(-Land_Type, -soilTimeScale.x) %>%
rename(soilTimeScale = soilTimeScale.y) %>%
na.omit() %>%
mutate(GCAM_Rate = (final_soil_c - initial_soil_c)/soilTimeScale, Rate_Difference = Rate - GCAM_Rate) %>%
mutate(Experimental_k = -log(abs(Rate)*Time +1)/Time) %>%
mutate(GCAM_k = -log(final_soil_c/initial_soil_c)/Time) -> Rate_Comparison
PostKwon <- read.csv(file= 'C:/Users/bian240/OneDrive - PNNL/Desktop/Initial Project Code/Experimental Data.csv', na.strings = c("", "NA"))
PostKwon %>%
select(Initial_Land_Use, Final_Land_Use, GLU_code, GCAM_region_ID, Time, GCAM_Rate) %>%
na.omit() %>%
mutate(Land_Type = Initial_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(initial_soil_c = soil_c) %>%
select(-Land_Type) %>%
mutate(Land_Type = Final_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(final_soil_c = soil_c) %>%
select(-Land_Type, -soilTimeScale.x) %>%
rename(soilTimeScale = soilTimeScale.y) %>%
na.omit() %>%
mutate(GCAM_Rate = (final_soil_c - initial_soil_c)/soilTimeScale, Rate_Difference = Exp_Rate - GCAM_Rate) %>%
mutate(Experimental_k = -log(abs(Exp_Rate)*Time +1)/Time) %>%
mutate(GCAM_k = -log(final_soil_c/initial_soil_c)/Time) -> Rate_Comparison
PostKwon %>%
select(Initial_Land_Use, Final_Land_Use, GLU_code, GCAM_region_ID, Time, Exp_Rate) %>%
na.omit() %>%
mutate(Land_Type = Initial_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(initial_soil_c = soil_c) %>%
select(-Land_Type) %>%
mutate(Land_Type = Final_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(final_soil_c = soil_c) %>%
select(-Land_Type, -soilTimeScale.x) %>%
rename(soilTimeScale = soilTimeScale.y) %>%
na.omit() %>%
mutate(GCAM_Rate = (final_soil_c - initial_soil_c)/soilTimeScale, Rate_Difference = Exp_Rate - GCAM_Rate) %>%
mutate(Experimental_k = -log(abs(Exp_Rate)*Time +1)/Time) %>%
mutate(GCAM_k = -log(final_soil_c/initial_soil_c)/Time) -> Rate_Comparison
#Plot the two rates against each other with a 1:1 line as well
ggplot(data = Rate_Comparison, aes(x = Rate, y = GCAM_Rate)) +
geom_point() +
geom_abline() +
xlab('Experimental Rates') + ylab('GCAM Derived Rates')
#Plot the two rates against each other with a 1:1 line as well
ggplot(data = Rate_Comparison, aes(x = Exp_Rate, y = GCAM_Rate)) +
geom_point() +
geom_abline() +
xlab('Experimental Rates') + ylab('GCAM Derived Rates')
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Exp_Rate, fill ='Experimental Rate' ), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_Rate, fill = 'GCAM Rate'), alpha = 0.5) +
xlab('Rate') + ylab('Count') +
scale_fill_manual(values = c('Experimental Rate' = '#45912c', 'GCAM Rate'='#e3962b'))
#Plot overlapping rate histograms for the different rate sources
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Experimental_k,fill ='Experimental k'), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_k,  fill = 'GCAM k'), alpha = 0.5) +
xlab('k') + ylab('Count') +
scale_fill_manual(values = c('Experimental k' = '#45912c', 'GCAM k'='#e3962b'))
?sign
Rate_Comparison
PostKwon %>%
select(Initial_Land_Use, Final_Land_Use, GLU_code, GCAM_region_ID, Time, Exp_Rate) %>%
na.omit() %>%
mutate(Land_Type = Initial_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(initial_soil_c = soil_c) %>%
select(-Land_Type) %>%
mutate(Land_Type = Final_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(final_soil_c = soil_c) %>%
select(-Land_Type, -soilTimeScale.x) %>%
rename(soilTimeScale = soilTimeScale.y) %>%
na.omit() %>%
mutate(GCAM_Rate = (final_soil_c - initial_soil_c)/soilTimeScale, Rate_Difference = Exp_Rate - GCAM_Rate) %>%
mutate(Exp_k = -log(abs(Exp_Rate)*Time +1)/Time) %>%
mutate(GCAM_k = -log(final_soil_c/initial_soil_c)/Time) -> Rate_Comparison
for (i in Rate_Comparison$Exp_k) {
if (sign(Rate_Comparison$Exp_k)[i] == sign(Rate_Comparison$Exp_Rate[i])){
Rate_Comparison$Exp_k[i] <- -1* Rate_Comparison$Exp_k[i]
}
}
PostKwon %>%
select(Initial_Land_Use, Final_Land_Use, GLU_code, GCAM_region_ID, Time, Exp_Rate) %>%
na.omit() %>%
mutate(Land_Type = Initial_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(initial_soil_c = soil_c) %>%
select(-Land_Type) %>%
mutate(Land_Type = Final_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(final_soil_c = soil_c) %>%
select(-Land_Type, -soilTimeScale.x) %>%
rename(soilTimeScale = soilTimeScale.y) %>%
na.omit() %>%
mutate(GCAM_Rate = (final_soil_c - initial_soil_c)/soilTimeScale, Rate_Difference = Exp_Rate - GCAM_Rate) %>%
mutate(Exp_k = -log(abs(Exp_Rate)*Time +1)/Time) %>%
mutate(GCAM_k = -log(final_soil_c/initial_soil_c)/Time) %>%
mutate(Exp_k = ifelse(sign(Exp_k) == sign(Exp_Rate), Exp_k*(-1)), Exp_k) -> Rate_Comparison
PostKwon %>%
select(Initial_Land_Use, Final_Land_Use, GLU_code, GCAM_region_ID, Time, Exp_Rate) %>%
na.omit() %>%
mutate(Land_Type = Initial_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(initial_soil_c = soil_c) %>%
select(-Land_Type) %>%
mutate(Land_Type = Final_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(final_soil_c = soil_c) %>%
select(-Land_Type, -soilTimeScale.x) %>%
rename(soilTimeScale = soilTimeScale.y) %>%
na.omit() %>%
mutate(GCAM_Rate = (final_soil_c - initial_soil_c)/soilTimeScale, Rate_Difference = Exp_Rate - GCAM_Rate) %>%
mutate(Exp_k = -log(abs(Exp_Rate)*Time +1)/Time) %>%
mutate(GCAM_k = -log(final_soil_c/initial_soil_c)/Time) %>%
mutate(Exp_k = ifelse(sign(Exp_k) == sign(Exp_Rate), Exp_k*(-1), Exp_k)) -> Rate_Comparison
Rate_Comparison
View(Rate_Comparison)
ggplot(data = Rate_Comparison, aes(x = Exp_Rate, y = GCAM_Rate)) +
geom_point() +
geom_abline() +
xlab('Experimental Rates') + ylab('GCAM Derived Rates')
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Exp_Rate, fill ='Experimental Rate' ), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_Rate, fill = 'GCAM Rate'), alpha = 0.5) +
xlab('Rate') + ylab('Count') +
scale_fill_manual(values = c('Experimental Rate' = '#45912c', 'GCAM Rate'='#e3962b'))
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Exp_k,fill ='Experimental k'), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_k,  fill = 'GCAM k'), alpha = 0.5) +
xlab('k') + ylab('Count') +
scale_fill_manual(values = c('Experimental k' = '#45912c', 'GCAM k'='#e3962b'))
ggplot(data = Rate_Comparison, aes(x = Exp_Rate, y = GCAM_Rate)) +
geom_point(aes(shape = 'Final_Land_Use', color = 'Initial_Land_Use')) +
geom_abline() +
xlab('Experimental Rates') + ylab('GCAM Derived Rates')
ggplot(data = Rate_Comparison, aes(x = Exp_Rate, y = GCAM_Rate)) +
geom_point(aes(shape = `Final_Land_Use`, color = `Initial_Land_Use`)) +
geom_abline() +
xlab('Experimental Rates') + ylab('GCAM Derived Rates')
ggplot(data = Rate_Comparison, aes(x = Exp_Rate, y = GCAM_Rate)) +
geom_point(aes(shape = `Final_Land_Use`, color = `Initial_Land_Use`, size = 4)) +
geom_abline() +
xlab('Experimental Rates') + ylab('GCAM Derived Rates')
ggplot(data = Rate_Comparison, aes(x = Exp_Rate, y = GCAM_Rate)) +
geom_point(aes(shape = `Final_Land_Use`, color = `Initial_Land_Use`, size = 3)) +
geom_abline() +
xlab('Experimental Rates') + ylab('GCAM Derived Rates')
ggplot(data = Rate_Comparison, aes(x = Exp_Rate, y = GCAM_Rate)) +
geom_point(aes(shape = `Final_Land_Use`, color = `Initial_Land_Use`, size = 2)) +
geom_abline() +
xlab('Experimental Rates') + ylab('GCAM Derived Rates')
ggplot(data = Rate_Comparison, aes(x = Exp_Rate, y = GCAM_Rate)) +
geom_point(aes(shape = `Final_Land_Use`, color = `Initial_Land_Use`, fill = NA, size = 2)) +
geom_abline() +
xlab('Experimental Rates') + ylab('GCAM Derived Rates')
ggplot(data = Rate_Comparison, aes(x = Exp_Rate, y = GCAM_Rate)) +
geom_point(aes(shape = `Final_Land_Use`, color = `Initial_Land_Use`, size = 2)) +
scale_shape(solid = FALSE) +
geom_abline() +
xlab('Experimental Rates') + ylab('GCAM Derived Rates')
PostKwon %>%
select(Initial_Land_Use, Final_Land_Use, GLU_code, GCAM_region_ID, Time, Exp_Rate) %>%
na.omit() %>%
mutate(Land_Type = Initial_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(initial_soil_c = soil_c) %>%
select(-Land_Type) %>%
mutate(Land_Type = Final_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(final_soil_c = soil_c) %>%
select(-Land_Type, -soilTimeScale.x) %>%
rename(soilTimeScale = soilTimeScale.y) %>%
na.omit() %>%
mutate(GCAM_Rate = (final_soil_c - initial_soil_c)/soilTimeScale, Rate_Difference = Exp_Rate - GCAM_Rate,
(Exp_k = -log(abs(Exp_Rate)*Time +1)/Time),
GCAM_k = -log(final_soil_c/initial_soil_c)/Time,
ifelse(sign(Exp_k) == sign(Exp_Rate), Exp_k*(-1), Exp_k) ) -> Rate_Comparison
PostKwon %>%
select(Initial_Land_Use, Final_Land_Use, GLU_code, GCAM_region_ID, Time, Exp_Rate) %>%
na.omit() %>%
mutate(Land_Type = Initial_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(initial_soil_c = soil_c) %>%
select(-Land_Type) %>%
mutate(Land_Type = Final_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(final_soil_c = soil_c) %>%
select(-Land_Type, -soilTimeScale.x) %>%
rename(soilTimeScale = soilTimeScale.y) %>%
na.omit() %>%
mutate(GCAM_Rate = (final_soil_c - initial_soil_c)/soilTimeScale, Rate_Difference = Exp_Rate - GCAM_Rate,
(Exp_k = -log(abs(Exp_Rate)*Time +1)/Time),
GCAM_k = -log(final_soil_c/initial_soil_c)/Time,
) -> Rate_Comparison
Rate_Comparison
PostKwon %>%
select(Initial_Land_Use, Final_Land_Use, GLU_code, GCAM_region_ID, Time, Exp_Rate) %>%
na.omit() %>%
mutate(Land_Type = Initial_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(initial_soil_c = soil_c) %>%
select(-Land_Type) %>%
mutate(Land_Type = Final_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(final_soil_c = soil_c) %>%
select(-Land_Type, -soilTimeScale.x) %>%
rename(soilTimeScale = soilTimeScale.y) %>%
na.omit() %>%
mutate(GCAM_Rate = (final_soil_c - initial_soil_c)/soilTimeScale, Rate_Difference = Exp_Rate - GCAM_Rate,
Exp_k = -log(abs(Exp_Rate)*Time +1)/Time,
GCAM_k = -log(final_soil_c/initial_soil_c)/Time,
) -> Rate_Comparison
Rate_Comparison
PostKwon %>%
select(Initial_Land_Use, Final_Land_Use, GLU_code, GCAM_region_ID, Time, Exp_Rate) %>%
na.omit() %>%
mutate(Land_Type = Initial_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(initial_soil_c = soil_c) %>%
select(-Land_Type) %>%
mutate(Land_Type = Final_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(final_soil_c = soil_c) %>%
select(-Land_Type, -soilTimeScale.x) %>%
rename(soilTimeScale = soilTimeScale.y) %>%
na.omit() %>%
mutate(GCAM_Rate = (final_soil_c - initial_soil_c)/soilTimeScale, Rate_Difference = Exp_Rate - GCAM_Rate,
Exp_k = -log(abs(Exp_Rate)*Time +1)/Time,
GCAM_k = -log(final_soil_c/initial_soil_c)/Time,
) %>%
mutate(Exp_k = ifelse(sign(Exp_k) == sign(Exp_Rate), Exp_k*(-1), Exp_k)) -> Rate_Comparison
PostKwon %>%
select(Initial_Land_Use, Final_Land_Use, GLU_code, GCAM_region_ID, Time, Exp_Rate) %>%
na.omit() %>%
mutate(Land_Type = Initial_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(initial_soil_c = soil_c) %>%
select(-Land_Type) %>%
mutate(Land_Type = Final_Land_Use) %>%
right_join( select(simple_soilC_with_regions, -Continent), by = c('GLU_code', 'Land_Type', 'GCAM_region_ID')) %>%
rename(final_soil_c = soil_c) %>%
select(-Land_Type, -soilTimeScale.x) %>%
rename(soilTimeScale = soilTimeScale.y) %>%
na.omit() %>%
mutate(GCAM_Rate = (final_soil_c - initial_soil_c)/soilTimeScale, Rate_Difference = Exp_Rate - GCAM_Rate,
Exp_k = -log(abs(Exp_Rate)*Time +1)/Time,
GCAM_k = -log(final_soil_c/initial_soil_c)/Time,
) %>%
mutate(Exp_k = ifelse(sign(Exp_k) == sign(Exp_Rate), Exp_k*(-1), Exp_k)) -> Rate_Comparison
Rate_Comparison
#Plot the two rates against each other with a 1:1 line as well
ggplot(data = Rate_Comparison, aes(x = Exp_Rate, y = GCAM_Rate)) +
geom_point(aes(shape = `Final_Land_Use`, color = `Initial_Land_Use`, size = 2)) +
scale_shape(solid = FALSE) +
geom_abline() +
xlab('Experimental Rates') + ylab('GCAM Derived Rates')
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Exp_Rate, fill ='Experimental Rate' ), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_Rate, fill = 'GCAM Rate'), alpha = 0.5) +
xlab('Rate') + ylab('Count') +
scale_fill_manual(values = c('Experimental Rate' = '#45912c', 'GCAM Rate'='#e3962b'))
ggplot() +
geom_histogram(aes(x = Rate_Comparison$Exp_k,fill ='Experimental k'), alpha = 0.5) +
geom_histogram(aes(x = Rate_Comparison$GCAM_k,  fill = 'GCAM k'), alpha = 0.5) +
xlab('k') + ylab('Count') +
scale_fill_manual(values = c('Experimental k' = '#45912c', 'GCAM k'='#e3962b'))
t.test(Rate_Comparison$Exp_Rate, Rate_Comparison$GCAM_Rate, alternative = 'two.sided') ->Rate_T_test
Rate_T_test
t.test(Rate_Comparison$Exp_k, Rate_Comparison$GCAM_k, alternative = 'two.sided') ->k_T_test
k_T_test
